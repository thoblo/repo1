---
title: "Mijn website"
author: 'thoblo'
date: '2k20'
output: 
    flexdashboard::flex_dashboard:
        storyboard: true
        theme: flatly
---

```{r setup, include=FALSE}
library(tidyverse)
library(plotly)
library(heatmaply)
library(protoclust)
library(spotifyr)
library(compmus)
library(emo)
source('spotify.R')
source('playlists.R')
```

### Chart A`r emo::ji("sunglasses")`

Hallo **wereld**, welkom op mijn *website*. `r emo::ji("sunglasses")` `r emo::ji("ok_hand")` `r emo::ji("100")`




_________

* Hallo
  * 1...
  * 2...
  * 3...
* **Wereld!!!!** `r emo::ji("fire")`

1. Welkom
   1. op
   1. mijn
1. *website*

***
> Ik wens u een *prettige* dag. `r emo::ji("revolving_hearts")`

### Chart B


```{r}
plot(x = jaartallen_lijst, y = Gemiddelde_energy_per_jaar_lijst, type="l", col="blue",ylim = c(0,1), xlab = "Jaartal", ylab = "Waarde")
lines(x = jaartallen_lijst, y = Gemiddelde_danceability_per_jaar_lijst, type="l", col="pink")
lines(x = jaartallen_lijst, y = Gemiddelde_speechiness_per_jaar_lijst, type="l", col="green")
lines(x = jaartallen_lijst, y = Gemiddelde_acousticness_per_jaar_lijst, type="l", col="red")
lines(x = jaartallen_lijst, y = Gemiddelde_liveness_per_jaar_lijst, type="l", col="purple")
lines(x = jaartallen_lijst, y = Gemiddelde_valence_per_jaar_lijst, type="l", col="black")
legend(1965, 1.02, legend=c("Energy", "Danceability","Speechiness", "Acousticness", "Liveness", "Valence"),
       col=c("blue", "pink", "green", "red", "purple", "black"), lty=1, cex=0.5)

```

___________
Deze tabel bevat belangrijke informatie

Hallo  | **wereld**
-------|------------
Welkom | op
mijn   | *website*


### Chart C

```{r}
#Gemiddelde energy, valence etc van Top 100 alle jaren
Top100EnergyAlleJarenGemiddeld <- mean(top_100_over_alle_jaren$energy, na.rm = TRUE)
Top100DanceabilityAlleJarenGemiddeld <- mean(top_100_over_alle_jaren$danceability, na.rm = TRUE)
Top100SpeechinessAlleJarenGemiddeld <- mean(top_100_over_alle_jaren$speechiness, na.rm = TRUE)
Top100AcousticnessAlleJarenGemiddeld <- mean(top_100_over_alle_jaren$acousticness, na.rm = TRUE)
Top100LivenessAlleJarenGemiddeld <- mean(top_100_over_alle_jaren$liveness, na.rm = TRUE)
Top100ValenceAlleJarenGemiddeld <- mean(top_100_over_alle_jaren$valence, na.rm = TRUE)

#Boxplots van energy, valence etc van alle koren
Alle_koren_energy_plot <-
  Alle_koren %>%
  ggplot(aes(x = Koor, y = energy)) +
  geom_boxplot() +
  xlab("Koren") +
  ylab("Energy") +
  geom_hline(yintercept=Top100EnergyAlleJarenGemiddeld, linetype="dashed")

Alle_koren_danceability_plot <-
  Alle_koren %>%
  ggplot(aes(x = Koor, y = danceability)) +
  geom_boxplot() +
  xlab("Koren") +
  ylab("Danceability") +
  geom_hline(yintercept=Top100DanceabilityAlleJarenGemiddeld, linetype="dashed")

Alle_koren_speechiness_plot <-
  Alle_koren %>%
  ggplot(aes(x = Koor, y = speechiness)) +
  geom_boxplot() +
  xlab("Koren") +
  ylab("Speechiness") +
  geom_hline(yintercept=Top100SpeechinessAlleJarenGemiddeld, linetype="dashed")

Alle_koren_acousticness_plot <-
  Alle_koren %>%
  ggplot(aes(x = Koor, y = acousticness)) +
  geom_boxplot() +
  xlab("Koren") +
  ylab("Acousticness") +
  geom_hline(yintercept=Top100AcousticnessAlleJarenGemiddeld, linetype="dashed")

Alle_koren_liveness_plot <-
  Alle_koren %>%
  ggplot(aes(x = Koor, y = liveness)) +
  geom_boxplot() +
  xlab("Koren") +
  ylab("Liveness") +
  geom_hline(yintercept=Top100LivenessAlleJarenGemiddeld, linetype="dashed")

Alle_koren_valence_plot <-
  Alle_koren %>%
  ggplot(aes(x = Koor, y = valence)) +
  geom_boxplot() +
  xlab("Koren") +
  ylab("Valence") +
  geom_hline(yintercept=Top100ValenceAlleJarenGemiddeld, linetype="dashed")


#Weergeven van plots
Alle_koren_energy_plot
Alle_koren_danceability_plot
Alle_koren_speechiness_plot
Alle_koren_acousticness_plot
Alle_koren_liveness_plot
Alle_koren_valence_plot
```

______
Koor 1 = Firma Vocaal

Koor 2 = Popolo

Koor 3 = Studentenkoort Tilburg

Koor 4 = Vocal Essen

Koor 5 = Plica

Koor 6 = UCK Utrecht

### Chart D


```{r}
ScatterEnergyValence <-
  Alle_koren_met_koornaam %>%
  ggplot(                      # Set up the plot.
    aes(
      x = valence,
      y = energy,
      size = loudness,
      colour = Koor,
      label = track.name   # Labels will be interactively visible.
    )
  ) +
  geom_point() +               # Scatter plot.
  geom_rug(size = 0.1) +       # Add 'fringes' to show data distribution.
  scale_x_continuous(          # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),  # Use grid-lines for quadrants only.
    minor_breaks = NULL      # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(          # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(         # Use the Color Brewer to choose a palette.
    type = "qual",           # Qualitative set.
    palette = "Set2"       # Name of the palette is 'Set2'.
  ) +
  scale_size_continuous(       # Fine-tune the sizes of each point.
    trans = "exp",           # Use an exp transformation to emphasise loud.
    guide = "none"           # Remove the legend for size.
  ) +
  theme_light() +              # Use a simpler them.
  labs(                        # Make the titles nice.
    x = "Valence",
    y = "Energy",
    colour = "Koor"
  )

ScatterDanceabilityAcousticness <-
  Alle_koren_met_koornaam %>%
  ggplot(                      # Set up the plot.
    aes(
      x = acousticness,
      y = danceability,
      size = loudness,
      colour = Koor,
      label = track.name   # Labels will be interactively visible.
    )
  ) +
  geom_point() +               # Scatter plot.
  geom_rug(size = 0.1) +       # Add 'fringes' to show data distribution.
  scale_x_continuous(          # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),  # Use grid-lines for quadrants only.
    minor_breaks = NULL      # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(          # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(         # Use the Color Brewer to choose a palette.
    type = "qual",           # Qualitative set.
    palette = "Set2"       # Name of the palette is 'Set2'.
  ) +
  scale_size_continuous(       # Fine-tune the sizes of each point.
    trans = "exp",           # Use an exp transformation to emphasise loud.
    guide = "none"           # Remove the legend for size.
  ) +
  theme_light() +              # Use a simpler them.
  labs(                        # Make the titles nice.
    x = "Acousticness",
    y = "Danceability",
    colour = "Koor"
  )

ScatterSpeechinessLiveness <-
  Alle_koren_met_koornaam %>%
  ggplot(                      # Set up the plot.
    aes(
      x = liveness,
      y = speechiness,
      size = loudness,
      colour = Koor,
      label = track.name   # Labels will be interactively visible.
    )
  ) +
  geom_point() +               # Scatter plot.
  geom_rug(size = 0.1) +       # Add 'fringes' to show data distribution.
  scale_x_continuous(          # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),  # Use grid-lines for quadrants only.
    minor_breaks = NULL      # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(          # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(         # Use the Color Brewer to choose a palette.
    type = "qual",           # Qualitative set.
    palette = "Set2"       # Name of the palette is 'Set2'.
  ) +
  scale_size_continuous(       # Fine-tune the sizes of each point.
    trans = "exp",           # Use an exp transformation to emphasise loud.
    guide = "none"           # Remove the legend for size.
  ) +
  theme_light() +              # Use a simpler them.
  labs(                        # Make the titles nice.
    x = "Liveness",
    y = "Speechiness",
    colour = "Koor"
  )


#ggplotly(ScatterEnergyValence)
#ggplotly(ScatterDanceabilityAcousticness)
#ggplotly(ScatterSpeechinessLiveness)
ScatterEnergyValence
ScatterDanceabilityAcousticness
ScatterSpeechinessLiveness
```


_____________

Deze drie scatterplots laten zien hoe de energy en valence, de danceability en acousticness en de speechiness en liveness zich tot elkaar verhouden voor de nummbers in het repertoir van de zes koren. Door te klikken op de naam van een koor in de legenda van een van de scatterplots worden deze punten weggelaten, door dubbel te klikken worden de punten van de vijf andere koren weggelaten.

In de laatste grafiek is het misschien handiger om te herschalen zodat liveness en speechiness van 0 tot 0.5 lopen. We missen dan alleen drie nummers in de grafiek.

